
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Separation</title>
<meta name="description" content="Documentation of Coq module Separation" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Separation</h1>
<div class="coq">
<div class="doc">Heaps and heap assertions for separation logics. </div>
<br/>
<span class="id">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.ZArith.html">ZArith</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Lia.html">Lia</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html">Bool</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Strings.String.html">String</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="id">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html">FunctionalExtensionality</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.PropExtensionality.html">PropExtensionality</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">Z_scope</span>.<br/>
<br/>
<h1> 1. Memory heaps </h1>
<br/>
<div class="doc">A memory heap is a partial function from addresses (memory locations) 
    to values, with a finite domain. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="addr">addr</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="heap">heap</a></span> : <span class="kwd">Type</span> := {<br/>
&nbsp;&nbsp;<span class="id"><a name="contents">contents</a></span> :&gt; <span class="id"><a href="CDF.Separation.html#addr">addr</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="isfinite">isfinite</a></span> :  <span class="id">exists</span> <span class="id">i</span>, <span class="kwd">forall</span> <span class="id">j</span>, <span class="id">i</span> &lt;= <span class="id">j</span> -&gt; <span class="id">contents</span> <span class="id">j</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
}.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="heap_extensionality">heap_extensionality</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">h1</span> <span class="id">h2</span>: <span class="id"><a href="CDF.Separation.html#heap">heap</a></span>),<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">l</span>, <span class="id">h1</span> <span class="id">l</span> = <span class="id">h2</span> <span class="id">l</span>) -&gt; <span class="id">h1</span> = <span class="id">h2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</div>
<div class="proofscript" id="proof71">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">h1</span> <span class="kwd">as</span> [<span class="id">c1</span> <span class="id">fin1</span>], <span class="id">h2</span> <span class="kwd">as</span> [<span class="id">c2</span> <span class="id">fin2</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">c1</span> = <span class="id">c2</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">c2</span>. <span class="tactic">f_equal</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.PropExtensionality.html#proof_irrelevance">proof_irrelevance</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">The empty heap. </div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="hempty">hempty</a></span> : <span class="id"><a href="CDF.Separation.html#heap">heap</a></span> :=<br/>
&nbsp;&nbsp;{| <span class="id"><a href="CDF.Separation.html#contents">contents</a></span> := <span class="kwd">fun</span> <span class="id">l</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> |}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof72')">Next Obligation.</div>
<div class="proofscript" id="proof72">
&nbsp;&nbsp;<span class="id">exists</span> 0; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">The heap that contains <span class="bracket"><span class="id">v</span></span> at address <span class="bracket"><span class="id">l</span></span> and is equal to <span class="bracket"><span class="id">h</span></span> on
    all other addresses. </div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="hupdate">hupdate</a></span> (<span class="id">l</span>: <span class="id"><a href="CDF.Separation.html#addr">addr</a></span>) (<span class="id">v</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">h</span>: <span class="id"><a href="CDF.Separation.html#heap">heap</a></span>) : <span class="id"><a href="CDF.Separation.html#heap">heap</a></span> :=<br/>
&nbsp;&nbsp;{| <span class="id"><a href="CDF.Separation.html#contents">contents</a></span> := <span class="kwd">fun</span> <span class="id">l</span>' =&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eq_dec">Z.eq_dec</a></span> <span class="id">l</span> <span class="id">l</span>' <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> <span class="kwd">else</span> <span class="id">h</span> <span class="id">l</span>' |}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof73')">Next Obligation.</div>
<div class="proofscript" id="proof73">
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CDF.Separation.html#isfinite">isfinite</a></span> <span class="id">h</span>) <span class="kwd">as</span> (<span class="id">i</span> &amp; <span class="id">fin</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id">i</span> (<span class="id">l</span> + 1)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eq_dec">Z.eq_dec</a></span> <span class="id">l</span> <span class="id">j</span>). <span class="id">lia</span>. <span class="tactic">apply</span> <span class="id">fin</span>; <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="hupdate_same">hupdate_same</a></span>: <span class="kwd">forall</span> <span class="id">l</span> <span class="id">v</span> <span class="id">h</span>, (<span class="id"><a href="CDF.Separation.html#hupdate">hupdate</a></span> <span class="id">l</span> <span class="id">v</span> <span class="id">h</span>) <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</div>
<div class="proofscript" id="proof74">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">cbn</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eq_dec">Z.eq_dec</a></span> <span class="id">l</span> <span class="id">l</span>); <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="hupdate_other">hupdate_other</a></span>: <span class="kwd">forall</span> <span class="id">l</span> <span class="id">v</span> <span class="id">h</span> <span class="id">l</span>', <span class="id">l</span> &lt;&gt; <span class="id">l</span>' -&gt; (<span class="id"><a href="CDF.Separation.html#hupdate">hupdate</a></span> <span class="id">l</span> <span class="id">v</span> <span class="id">h</span>) <span class="id">l</span>' = <span class="id">h</span> <span class="id">l</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</div>
<div class="proofscript" id="proof75">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">cbn</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eq_dec">Z.eq_dec</a></span> <span class="id">l</span> <span class="id">l</span>'); <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">The heap <span class="bracket"><span class="id">h</span></span> after deallocating address <span class="bracket"><span class="id">l</span></span>. </div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="hfree">hfree</a></span> (<span class="id">l</span>: <span class="id"><a href="CDF.Separation.html#addr">addr</a></span>) (<span class="id">h</span>: <span class="id"><a href="CDF.Separation.html#heap">heap</a></span>) : <span class="id"><a href="CDF.Separation.html#heap">heap</a></span> :=<br/>
&nbsp;&nbsp;{| <span class="id"><a href="CDF.Separation.html#contents">contents</a></span> := <span class="kwd">fun</span> <span class="id">l</span>' =&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eq_dec">Z.eq_dec</a></span> <span class="id">l</span> <span class="id">l</span>' <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="kwd">else</span> <span class="id">h</span> <span class="id">l</span>' |}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof76')">Next Obligation.</div>
<div class="proofscript" id="proof76">
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CDF.Separation.html#isfinite">isfinite</a></span> <span class="id">h</span>) <span class="kwd">as</span> (<span class="id">i</span> &amp; <span class="id">fin</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">i</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eq_dec">Z.eq_dec</a></span> <span class="id">l</span> <span class="id">j</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">The heap <span class="bracket"><span class="id">h</span></span> where addresses <span class="bracket"><span class="id">l</span>, ..., <span class="id">l</span> + <span class="id">sz</span> - 1</span> are initialized to 0. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="hinit">hinit</a></span> (<span class="id">l</span>: <span class="id"><a href="CDF.Separation.html#addr">addr</a></span>) (<span class="id">sz</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span class="id">h</span>: <span class="id"><a href="CDF.Separation.html#heap">heap</a></span>) : <span class="id"><a href="CDF.Separation.html#heap">heap</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">sz</span> <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> =&gt; <span class="id">h</span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">sz</span> =&gt; <span class="id"><a href="CDF.Separation.html#hupdate">hupdate</a></span> <span class="id">l</span> 0 (<span class="id">hinit</span> (<span class="id">l</span> + 1) <span class="id">sz</span> <span class="id">h</span>) <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="hinit_inside">hinit_inside</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h</span> <span class="id">sz</span> <span class="id">l</span> <span class="id">l</span>', <span class="id">l</span> &lt;= <span class="id">l</span>' &lt; <span class="id">l</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">sz</span> -&gt; <span class="id"><a href="CDF.Separation.html#hinit">hinit</a></span> <span class="id">l</span> <span class="id">sz</span> <span class="id">h</span> <span class="id">l</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</div>
<div class="proofscript" id="proof77">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">sz</span>; <span class="tactic">intros</span>; <span class="id">cbn</span>.<br/>
- <span class="id">lia</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eq_dec">Z.eq_dec</a></span> <span class="id">l</span> <span class="id">l</span>'); <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">IHsz</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="hinit_outside">hinit_outside</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h</span> <span class="id">sz</span> <span class="id">l</span> <span class="id">l</span>', <span class="id">l</span>' &lt; <span class="id">l</span> \/ <span class="id">l</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">sz</span> &lt;= <span class="id">l</span>' -&gt; <span class="id"><a href="CDF.Separation.html#hinit">hinit</a></span> <span class="id">l</span> <span class="id">sz</span> <span class="id">h</span> <span class="id">l</span>' = <span class="id">h</span> <span class="id">l</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof78')">Proof.</div>
<div class="proofscript" id="proof78">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">sz</span>; <span class="tactic">intros</span>; <span class="id">cbn</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eq_dec">Z.eq_dec</a></span> <span class="id">l</span> <span class="id">l</span>'). <span class="id">lia</span>. <span class="tactic">apply</span> <span class="id">IHsz</span>; <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<div class="doc">The disjoint union of two heaps. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="hdisjoint">hdisjoint</a></span> (<span class="id">h1</span> <span class="id">h2</span>: <span class="id"><a href="CDF.Separation.html#heap">heap</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>, <span class="id">h1</span> <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> \/ <span class="id">h2</span> <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="hdisjoint_sym">hdisjoint_sym</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h1</span> <span class="id">h2</span>, <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">h1</span> <span class="id">h2</span> &lt;-&gt; <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">h2</span> <span class="id">h1</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof79')">Proof.</div>
<div class="proofscript" id="proof79">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span>; <span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">H</span> <span class="id">l</span>; <span class="id">specialize</span> (<span class="id">H</span> <span class="id">l</span>); <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="hunion">hunion</a></span> (<span class="id">h1</span> <span class="id">h2</span>: <span class="id"><a href="CDF.Separation.html#heap">heap</a></span>) : <span class="id"><a href="CDF.Separation.html#heap">heap</a></span> :=<br/>
&nbsp;&nbsp;{| <span class="id"><a href="CDF.Separation.html#contents">contents</a></span> := <span class="kwd">fun</span> <span class="id">l</span> =&gt; <span class="kwd">if</span> <span class="id">h1</span> <span class="id">l</span> <span class="kwd">then</span> <span class="id">h1</span> <span class="id">l</span> <span class="kwd">else</span> <span class="id">h2</span> <span class="id">l</span> |}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof80')">Next Obligation.</div>
<div class="proofscript" id="proof80">
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CDF.Separation.html#isfinite">isfinite</a></span> <span class="id">h1</span>) <span class="kwd">as</span> (<span class="id">i1</span> &amp; <span class="id">fin1</span>), (<span class="id"><a href="CDF.Separation.html#isfinite">isfinite</a></span> <span class="id">h2</span>) <span class="kwd">as</span> (<span class="id">i2</span> &amp; <span class="id">fin2</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id">i1</span> <span class="id">i2</span>); <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">fin1</span>, <span class="id">fin2</span> <span class="tactic">by</span> <span class="id">lia</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="hunion_comm">hunion_comm</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h1</span> <span class="id">h2</span>, <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">h1</span> <span class="id">h2</span> -&gt; <span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id">h2</span> <span class="id">h1</span> = <span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id">h1</span> <span class="id">h2</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof81')">Proof.</div>
<div class="proofscript" id="proof81">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#heap_extensionality">heap_extensionality</a></span>; <span class="tactic">intros</span>; <span class="id">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">l</span>). <span class="tactic">destruct</span> (<span class="id">h1</span> <span class="id">l</span>), (<span class="id">h2</span> <span class="id">l</span>); <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="hunion_assoc">hunion_assoc</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h1</span> <span class="id">h2</span> <span class="id">h3</span>, <span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> (<span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id">h1</span> <span class="id">h2</span>) <span class="id">h3</span> = <span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id">h1</span> (<span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id">h2</span> <span class="id">h3</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof82')">Proof.</div>
<div class="proofscript" id="proof82">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#heap_extensionality">heap_extensionality</a></span>; <span class="tactic">intros</span>; <span class="id">cbn</span>. <span class="tactic">destruct</span> (<span class="id">h1</span> <span class="id">l</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="hunion_empty">hunion_empty</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h</span>, <span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id"><a href="CDF.Separation.html#hempty">hempty</a></span> <span class="id">h</span> = <span class="id">h</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof83')">Proof.</div>
<div class="proofscript" id="proof83">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#heap_extensionality">heap_extensionality</a></span>; <span class="tactic">intros</span>; <span class="id">cbn</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="hdisjoint_union_l">hdisjoint_union_l</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h1</span> <span class="id">h2</span> <span class="id">h3</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> (<span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id">h1</span> <span class="id">h2</span>) <span class="id">h3</span> &lt;-&gt; <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">h1</span> <span class="id">h3</span> /\ <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">h2</span> <span class="id">h3</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof84')">Proof.</div>
<div class="proofscript" id="proof84">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span>, <span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span>; <span class="id">cbn</span>; <span class="tactic">intros</span>. <span class="tactic">split</span>.<br/>
- <span class="tactic">intros</span> <span class="id">D</span>; <span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">l</span>; <span class="tactic">destruct</span> (<span class="id">D</span> <span class="id">l</span>); <span class="tactic">auto</span>; <span class="tactic">destruct</span> (<span class="id">h1</span> <span class="id">l</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
- <span class="tactic">intros</span> [<span class="id">D1</span> <span class="id">D2</span>] <span class="id">l</span>. <span class="tactic">destruct</span> (<span class="id">D2</span> <span class="id">l</span>); <span class="tactic">auto</span>. <span class="tactic">destruct</span> (<span class="id">h1</span> <span class="id">l</span>) <span class="id">eqn</span>:<span class="id">H1</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> (<span class="id">D1</span> <span class="id">l</span>); <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="hdisjoint_union_r">hdisjoint_union_r</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h1</span> <span class="id">h2</span> <span class="id">h3</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">h1</span> (<span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id">h2</span> <span class="id">h3</span>) &lt;-&gt; <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">h1</span> <span class="id">h2</span> /\ <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">h1</span> <span class="id">h3</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof85')">Proof.</div>
<div class="proofscript" id="proof85">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hdisjoint_sym">hdisjoint_sym</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hdisjoint_union_l">hdisjoint_union_l</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CDF.Separation.html#hdisjoint_sym">hdisjoint_sym</a></span> <span class="id">h2</span>), (<span class="id"><a href="CDF.Separation.html#hdisjoint_sym">hdisjoint_sym</a></span> <span class="id">h3</span>). <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Disjointness between three heaps. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="hdisj3">hdisj3</a></span> (<span class="id">h1</span> <span class="id">h2</span> <span class="id">h3</span>: <span class="id"><a href="CDF.Separation.html#heap">heap</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">h1</span> <span class="id">h2</span> /\ <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">h1</span> <span class="id">h3</span> /\ <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">h2</span> <span class="id">h3</span>.<br/>
<br/>
<div class="doc">A tactic to prove disjointness statements. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">HDISJ</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id"><a href="CDF.Separation.html#hdisj3">hdisj3</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (? &amp; ? &amp; ?); <span class="id">HDISJ</span><br/>
&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> (<span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">_</span> |- <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#hdisjoint_union_l">hdisjoint_union_l</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="id">HDISJ</span><br/>
&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">_</span> (<span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id">_</span> <span class="id">_</span>) |- <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#hdisjoint_union_r">hdisjoint_union_r</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="id">HDISJ</span><br/>
&nbsp;&nbsp;| [ |- <span class="id"><a href="CDF.Separation.html#hdisj3">hdisj3</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [|<span class="tactic">split</span>]; <span class="id">HDISJ</span><br/>
&nbsp;&nbsp;| [ |- <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> (<span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#hdisjoint_union_l">hdisjoint_union_l</a></span>; <span class="tactic">split</span>; <span class="id">HDISJ</span><br/>
&nbsp;&nbsp;| [ |- <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">_</span> (<span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id">_</span> <span class="id">_</span>) ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#hdisjoint_union_r">hdisjoint_union_r</a></span>; <span class="tactic">split</span>; <span class="id">HDISJ</span><br/>
&nbsp;&nbsp;| [ |- <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id"><a href="CDF.Separation.html#hempty">hempty</a></span> <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;| [ |- <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">_</span> <span class="id"><a href="CDF.Separation.html#hempty">hempty</a></span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span><br/>
&nbsp;&nbsp;| [ |- <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">_</span> <span class="id">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span> || (<span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#hdisjoint_sym">hdisjoint_sym</a></span>; <span class="tactic">assumption</span>) || <span class="id">idtac</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<h1> 2. Assertions for separation logic </h1>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="assertion">assertion</a></span> : <span class="kwd">Type</span> := <span class="id"><a href="CDF.Separation.html#heap">heap</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<div class="doc">Implication (entailment). </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="aimp">aimp</a></span> (<span class="id">P</span> <span class="id">Q</span>: <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h</span>, <span class="id">P</span> <span class="id">h</span> -&gt; <span class="id">Q</span> <span class="id">h</span>.<br/>
<br/>
<span class="kwd">Notation</span> "<span class="id">P</span> --&gt;&gt; <span class="id">Q</span>" := (<span class="id"><a href="CDF.Separation.html#aimp">aimp</a></span> <span class="id">P</span> <span class="id">Q</span>) (<span class="tactic">at</span> <span class="id">level</span> 95, <span class="id">no</span> <span class="id">associativity</span>).<br/>
<br/>
<div class="doc">Quantification. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="aexists">aexists</a></span> {<span class="id">A</span>: <span class="kwd">Type</span>} (<span class="id">P</span>: <span class="id">A</span> -&gt; <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span>) : <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">exists</span> <span class="id">a</span>: <span class="id">A</span>, <span class="id">P</span> <span class="id">a</span> <span class="id">h</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="aforall">aforall</a></span> {<span class="id">A</span>: <span class="kwd">Type</span>} (<span class="id">P</span>: <span class="id">A</span> -&gt; <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span>) : <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="kwd">forall</span> <span class="id">a</span>: <span class="id">A</span>, <span class="id">P</span> <span class="id">a</span> <span class="id">h</span>.<br/>
<br/>
<div class="doc">The assertion "the heap is empty". </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="emp">emp</a></span> : <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span> = <span class="id"><a href="CDF.Separation.html#hempty">hempty</a></span>.<br/>
<br/>
<div class="doc">The pure assertion: "the heap is empty and P holds". </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="pure">pure</a></span> (<span class="id">P</span>: <span class="kwd">Prop</span>) : <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">P</span> /\ <span class="id">h</span> = <span class="id"><a href="CDF.Separation.html#hempty">hempty</a></span>.<br/>
<br/>
<div class="doc">The assertion "address <span class="bracket"><span class="id">l</span></span> contains value <span class="bracket"><span class="id">v</span></span>". 
    The domain of the heap must be the singleton <span class="bracket">{<span class="id">l</span>}</span>. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="contains">contains</a></span> (<span class="id">l</span>: <span class="id"><a href="CDF.Separation.html#addr">addr</a></span>) (<span class="id">v</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) : <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span> = <span class="id"><a href="CDF.Separation.html#hupdate">hupdate</a></span> <span class="id">l</span> <span class="id">v</span> <span class="id"><a href="CDF.Separation.html#hempty">hempty</a></span>.<br/>
<br/>
<div class="doc">The assertion "address <span class="bracket"><span class="id">l</span></span> is valid" (i.e. in the domain of the heap). </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="valid">valid</a></span> (<span class="id">l</span>: <span class="id"><a href="CDF.Separation.html#addr">addr</a></span>) : <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span> := <span class="id"><a href="CDF.Separation.html#aexists">aexists</a></span> (<span class="id"><a href="CDF.Separation.html#contains">contains</a></span> <span class="id">l</span>).<br/>
<br/>
<div class="doc">The separating conjunction. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="sepconj">sepconj</a></span> (<span class="id">P</span> <span class="id">Q</span>: <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span>) : <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">exists</span> <span class="id">h1</span> <span class="id">h2</span>, <span class="id">P</span> <span class="id">h1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">Q</span> <span class="id">h2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">h1</span> <span class="id">h2</span>  /\ <span class="id">h</span> = <span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id">h1</span> <span class="id">h2</span>.<br/>
<br/>
<span class="kwd">Notation</span> "<span class="id">P</span> ** <span class="id">Q</span>" := (<span class="id"><a href="CDF.Separation.html#sepconj">sepconj</a></span> <span class="id">P</span> <span class="id">Q</span>) (<span class="tactic">at</span> <span class="id">level</span> 60, <span class="id">right</span> <span class="id">associativity</span>).<br/>
<br/>
<div class="doc">The conjunction of a simple assertion and a general assertion. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="pureconj">pureconj</a></span> (<span class="id">P</span>: <span class="kwd">Prop</span>) (<span class="id">Q</span>: <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span>) : <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">P</span> /\ <span class="id">Q</span> <span class="id">h</span>.<br/>
<br/>
<span class="kwd">Notation</span> "<span class="id">P</span> //\\ <span class="id">Q</span>" := (<span class="id"><a href="CDF.Separation.html#pureconj">pureconj</a></span> <span class="id">P</span> <span class="id">Q</span>) (<span class="tactic">at</span> <span class="id">level</span> 60, <span class="id">right</span> <span class="id">associativity</span>).<br/>
<br/>
<div class="doc">Extensional equality between assertions. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="assertion_extensionality">assertion_extensionality</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">P</span> <span class="id">Q</span>: <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span>),<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">h</span>, <span class="id">P</span> <span class="id">h</span> &lt;-&gt; <span class="id">Q</span> <span class="id">h</span>) -&gt; <span class="id">P</span> = <span class="id">Q</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof86')">Proof.</div>
<div class="proofscript" id="proof86">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FunctionalExtensionality.html#functional_extensionality">functional_extensionality</a></span>; <span class="tactic">intros</span> <span class="id">h</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.PropExtensionality.html#propositional_extensionality">propositional_extensionality</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Properties of separating conjunction </h2>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sepconj_comm">sepconj_comm</a></span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span>, <span class="id">P</span> ** <span class="id">Q</span> = <span class="id">Q</span> ** <span class="id">P</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof87')">Proof.</div>
<div class="proofscript" id="proof87">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">h</span>, (<span class="id">P</span> ** <span class="id">Q</span>) <span class="id">h</span> -&gt; (<span class="id">Q</span> ** <span class="id">P</span>) <span class="id">h</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">h</span> (<span class="id">h1</span> &amp; <span class="id">h2</span> &amp; <span class="id">P1</span> &amp; <span class="id">Q2</span> &amp; <span class="id">EQ</span> &amp; <span class="id">DISJ</span>); <span class="tactic">subst</span> <span class="id">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">h2</span>, <span class="id">h1</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#hdisjoint_sym">hdisjoint_sym</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>; <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#hunion_comm">hunion_comm</a></span>; <span class="tactic">auto</span>. } <br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#assertion_extensionality">assertion_extensionality</a></span>; <span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sepconj_assoc">sepconj_assoc</a></span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">R</span>, (<span class="id">P</span> ** <span class="id">Q</span>) ** <span class="id">R</span> = <span class="id">P</span> ** (<span class="id">Q</span> ** <span class="id">R</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof88')">Proof.</div>
<div class="proofscript" id="proof88">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#assertion_extensionality">assertion_extensionality</a></span>; <span class="tactic">intros</span>; <span class="tactic">split</span>.<br/>
- <span class="tactic">intros</span> (<span class="id">hx</span> &amp; <span class="id">h3</span> &amp; (<span class="id">h1</span> &amp; <span class="id">h2</span> &amp; <span class="id">P1</span> &amp; <span class="id">Q2</span> &amp; <span class="id">EQ</span> &amp; <span class="id">DISJ</span>) &amp; <span class="id">R3</span> &amp; <span class="id">EQ</span>' &amp; <span class="id">DISJ</span>'). <span class="tactic">subst</span> <span class="id">hx</span> <span class="id">h</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hdisjoint_union_l">hdisjoint_union_l</a></span> <span class="kwd">in</span> <span class="id">EQ</span>'. <span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hunion_assoc">hunion_assoc</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">h1</span>, (<span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id">h2</span> <span class="id">h3</span>); <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">h2</span>, <span class="id">h3</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hdisjoint_union_r">hdisjoint_union_r</a></span>; <span class="tactic">tauto</span>.<br/>
- <span class="tactic">intros</span> (<span class="id">h1</span> &amp; <span class="id">hx</span> &amp; <span class="id">P1</span> &amp; (<span class="id">h2</span> &amp; <span class="id">h3</span> &amp; <span class="id">Q2</span> &amp; <span class="id">R3</span> &amp; <span class="id">EQ</span> &amp; <span class="id">DISJ</span>) &amp; <span class="id">EQ</span>' &amp; <span class="id">DISJ</span>'). <span class="tactic">subst</span> <span class="id">hx</span> <span class="id">h</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hdisjoint_union_r">hdisjoint_union_r</a></span> <span class="kwd">in</span> <span class="id">EQ</span>'. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CDF.Separation.html#hunion_assoc">hunion_assoc</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id">h1</span> <span class="id">h2</span>), <span class="id">h3</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">h1</span>, <span class="id">h2</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hdisjoint_union_l">hdisjoint_union_l</a></span>; <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sepconj_emp">sepconj_emp</a></span>: <span class="kwd">forall</span> <span class="id">P</span>, <span class="id"><a href="CDF.Separation.html#emp">emp</a></span> ** <span class="id">P</span> = <span class="id">P</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof89')">Proof.</div>
<div class="proofscript" id="proof89">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#assertion_extensionality">assertion_extensionality</a></span>; <span class="tactic">intros</span>; <span class="tactic">split</span>.<br/>
- <span class="tactic">intros</span> (<span class="id">h1</span> &amp; <span class="id">h2</span> &amp; <span class="id">EMP1</span> &amp; <span class="id">P2</span> &amp; <span class="id">EQ</span> &amp; <span class="id">DISJ</span>). <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">EMP1</span>. <span class="tactic">subst</span> <span class="id">h</span> <span class="id">h1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hunion_empty">hunion_empty</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">intros</span>. <span class="id">exists</span> <span class="id"><a href="CDF.Separation.html#hempty">hempty</a></span>, <span class="id">h</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hunion_empty">hunion_empty</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sepconj_imp_l">sepconj_imp_l</a></span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">R</span>,<br/>
&nbsp;&nbsp;(<span class="id">P</span> --&gt;&gt; <span class="id">Q</span>) -&gt; (<span class="id">P</span> ** <span class="id">R</span> --&gt;&gt; <span class="id">Q</span> ** <span class="id">R</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof90')">Proof.</div>
<div class="proofscript" id="proof90">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">R</span> <span class="id">IMP</span> <span class="id">h</span> (<span class="id">h1</span> &amp; <span class="id">h2</span> &amp; <span class="id">P1</span> &amp; <span class="id">Q2</span> &amp; <span class="id">D</span> &amp; <span class="id">U</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">h1</span>, <span class="id">h2</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sepconj_imp_r">sepconj_imp_r</a></span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">R</span>,<br/>
&nbsp;&nbsp;(<span class="id">P</span> --&gt;&gt; <span class="id">Q</span>) -&gt; (<span class="id">R</span> ** <span class="id">P</span> --&gt;&gt; <span class="id">R</span> ** <span class="id">Q</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof91')">Proof.</div>
<div class="proofscript" id="proof91">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> ! (<span class="id"><a href="CDF.Separation.html#sepconj_comm">sepconj_comm</a></span> <span class="id">R</span>). <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#sepconj_imp_l">sepconj_imp_l</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Other useful logical properties </h2>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pure_sep">pure_sep</a></span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Separation.html#pure">pure</a></span> (<span class="id">P</span> /\ <span class="id">Q</span>) = <span class="id"><a href="CDF.Separation.html#pure">pure</a></span> <span class="id">P</span> ** <span class="id"><a href="CDF.Separation.html#pure">pure</a></span> <span class="id">Q</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof92')">Proof.</div>
<div class="proofscript" id="proof92">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#assertion_extensionality">assertion_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CDF.Separation.html#pure">pure</a></span>, <span class="id"><a href="CDF.Separation.html#sepconj">sepconj</a></span>. <span class="tactic">split</span>.<br/>
- <span class="tactic">intros</span> ((<span class="id">A</span> &amp; <span class="id">B</span>) &amp; <span class="id">C</span>). <span class="tactic">subst</span> <span class="id">h</span>. <span class="id">exists</span> <span class="id"><a href="CDF.Separation.html#hempty">hempty</a></span>, <span class="id"><a href="CDF.Separation.html#hempty">hempty</a></span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hunion_empty">hunion_empty</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">intros</span> (<span class="id">h1</span> &amp; <span class="id">h2</span> &amp; (<span class="id">PP</span> &amp; <span class="id">E1</span>) &amp; (<span class="id">QQ</span> &amp; <span class="id">E2</span>) &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hunion_empty">hunion_empty</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pureconj_sepconj">pureconj_sepconj</a></span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Separation.html#pure">pure</a></span> <span class="id">P</span> ** <span class="id">Q</span> = <span class="id">P</span> //\\ <span class="id">Q</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof93')">Proof.</div>
<div class="proofscript" id="proof93">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#assertion_extensionality">assertion_extensionality</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CDF.Separation.html#pure">pure</a></span>, <span class="id"><a href="CDF.Separation.html#sepconj">sepconj</a></span>, <span class="id"><a href="CDF.Separation.html#pureconj">pureconj</a></span>; <span class="tactic">split</span>.<br/>
- <span class="tactic">intros</span> (<span class="id">h1</span> &amp; <span class="id">h2</span> &amp; (<span class="id">A</span> &amp; <span class="id">B</span>) &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">E</span>).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hunion_empty">hunion_empty</a></span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">exists</span> <span class="id"><a href="CDF.Separation.html#hempty">hempty</a></span>, <span class="id">h</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>.  <br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">l</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hunion_empty">hunion_empty</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lift_pureconj">lift_pureconj</a></span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">R</span>, (<span class="id">P</span> //\\ <span class="id">Q</span>) ** <span class="id">R</span> = <span class="id">P</span> //\\ (<span class="id">Q</span> ** <span class="id">R</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof94')">Proof.</div>
<div class="proofscript" id="proof94">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- ! <span class="id"><a href="CDF.Separation.html#pureconj_sepconj">pureconj_sepconj</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#sepconj_assoc">sepconj_assoc</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lift_aexists">lift_aexists</a></span>: <span class="kwd">forall</span> (<span class="id">A</span>: <span class="kwd">Type</span>) (<span class="id">P</span>: <span class="id">A</span> -&gt; <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span>) <span class="id">Q</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Separation.html#aexists">aexists</a></span> <span class="id">P</span> ** <span class="id">Q</span> = <span class="id"><a href="CDF.Separation.html#aexists">aexists</a></span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">P</span> <span class="id">x</span> ** <span class="id">Q</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof95')">Proof.</div>
<div class="proofscript" id="proof95">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#assertion_extensionality">assertion_extensionality</a></span>; <span class="tactic">intros</span>; <span class="tactic">split</span>.<br/>
- <span class="tactic">intros</span> (<span class="id">h1</span> &amp; <span class="id">h2</span> &amp; (<span class="id">a</span> &amp; <span class="id">P1</span>) &amp; <span class="id">Q2</span> &amp; <span class="id">DISJ</span> &amp; <span class="id">EQ</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">a</span>, <span class="id">h1</span>, <span class="id">h2</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">intros</span> (<span class="id">a</span> &amp; <span class="id">h1</span> &amp; <span class="id">h2</span> &amp; <span class="id">P1</span> &amp; <span class="id">Q2</span> &amp; <span class="id">DISJ</span> &amp; <span class="id">EQ</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">h1</span>, <span class="id">h2</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>. <span class="id">exists</span> <span class="id">a</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sepconj_swap3">sepconj_swap3</a></span>: <span class="kwd">forall</span> <span class="id">R</span> <span class="id">P</span> <span class="id">Q</span>, <span class="id">P</span> ** <span class="id">Q</span> ** <span class="id">R</span> = <span class="id">R</span> ** <span class="id">P</span> ** <span class="id">Q</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof96')">Proof.</div>
<div class="proofscript" id="proof96">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CDF.Separation.html#sepconj_assoc">sepconj_assoc</a></span>, <span class="id"><a href="CDF.Separation.html#sepconj_comm">sepconj_comm</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sepconj_swap4">sepconj_swap4</a></span>: <span class="kwd">forall</span> <span class="id">S</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">R</span>, <span class="id">P</span> ** <span class="id">Q</span> ** <span class="id">R</span> ** <span class="id">S</span> = <span class="id">S</span> ** <span class="id">P</span> ** <span class="id">Q</span> ** <span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof97')">Proof.</div>
<div class="proofscript" id="proof97">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CDF.Separation.html#sepconj_assoc">sepconj_assoc</a></span>, <span class="id"><a href="CDF.Separation.html#sepconj_swap3">sepconj_swap3</a></span>, <span class="id"><a href="CDF.Separation.html#sepconj_assoc">sepconj_assoc</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sepconj_pick2">sepconj_pick2</a></span>: <span class="kwd">forall</span> <span class="id">Q</span> <span class="id">P</span> <span class="id">R</span>, <span class="id">P</span> ** <span class="id">Q</span> ** <span class="id">R</span> = <span class="id">Q</span> ** <span class="id">P</span> ** <span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof98')">Proof.</div>
<div class="proofscript" id="proof98">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> (<span class="id"><a href="CDF.Separation.html#sepconj_comm">sepconj_comm</a></span> <span class="id">Q</span>), &lt;- <span class="id"><a href="CDF.Separation.html#sepconj_assoc">sepconj_assoc</a></span>, <span class="id"><a href="CDF.Separation.html#sepconj_comm">sepconj_comm</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sepconj_pick3">sepconj_pick3</a></span>: <span class="kwd">forall</span> <span class="id">R</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">S</span>, <span class="id">P</span> ** <span class="id">Q</span> ** <span class="id">R</span> ** <span class="id">S</span> = <span class="id">R</span> ** <span class="id">P</span> ** <span class="id">Q</span> ** <span class="id">S</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof99')">Proof.</div>
<div class="proofscript" id="proof99">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> (<span class="id"><a href="CDF.Separation.html#sepconj_pick2">sepconj_pick2</a></span> <span class="id">R</span>), (<span class="id"><a href="CDF.Separation.html#sepconj_pick2">sepconj_pick2</a></span> <span class="id">P</span>). <span class="tactic">auto</span>. <br/>
Qed.</div>
<br/>
<h2> Magic wand </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="wand">wand</a></span> (<span class="id">P</span> <span class="id">Q</span>: <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span>) : <span class="id"><a href="CDF.Separation.html#assertion">assertion</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="kwd">forall</span> <span class="id">h</span>', <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">h</span> <span class="id">h</span>' -&gt; <span class="id">P</span> <span class="id">h</span>' -&gt; <span class="id">Q</span> (<span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id">h</span> <span class="id">h</span>').<br/>
<br/>
<span class="kwd">Notation</span> "<span class="id">P</span> --* <span class="id">Q</span>" := (<span class="id"><a href="CDF.Separation.html#wand">wand</a></span> <span class="id">P</span> <span class="id">Q</span>) (<span class="tactic">at</span> <span class="id">level</span> 70, <span class="id">right</span> <span class="id">associativity</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="wand_intro">wand_intro</a></span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">R</span>,<br/>
&nbsp;&nbsp;<span class="id">P</span> ** <span class="id">Q</span> --&gt;&gt; <span class="id">R</span>  -&gt;  <span class="id">P</span> --&gt;&gt; <span class="id">Q</span> --* <span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof100')">Proof.</div>
<div class="proofscript" id="proof100">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">R</span> <span class="id">IMP</span> <span class="id">h</span> <span class="id">Ph</span> <span class="id">h</span>' <span class="id">DISJ</span> <span class="id">Qh</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IMP</span>. <span class="id">exists</span> <span class="id">h</span>, <span class="id">h</span>'; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="wand_cancel">wand_cancel</a></span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span>,<br/>
&nbsp;&nbsp;<span class="id">P</span> ** (<span class="id">P</span> --* <span class="id">Q</span>) --&gt;&gt; <span class="id">Q</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof101')">Proof.</div>
<div class="proofscript" id="proof101">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">h</span> (<span class="id">h1</span> &amp; <span class="id">h2</span> &amp; <span class="id">Ph1</span> &amp; <span class="id">Wh2</span> &amp; <span class="id">D</span> &amp; <span class="id">U</span>). <span class="tactic">subst</span> <span class="id">h</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">D</span>': <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">h2</span> <span class="id">h1</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#hdisjoint_sym">hdisjoint_sym</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hunion_comm">hunion_comm</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">Wh2</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="wand_charact">wand_charact</a></span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span>,<br/>
&nbsp;&nbsp;(<span class="id">P</span> --*<span class="id">Q</span>) = (<span class="id"><a href="CDF.Separation.html#aexists">aexists</a></span> (<span class="kwd">fun</span> <span class="id">R</span> =&gt; (<span class="id">P</span> ** <span class="id">R</span> --&gt;&gt; <span class="id">Q</span>) //\\ <span class="id">R</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof102')">Proof.</div>
<div class="proofscript" id="proof102">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">P</span> <span class="id">Q</span>; <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#assertion_extensionality">assertion_extensionality</a></span>; <span class="tactic">intros</span> <span class="id">h</span>; <span class="tactic">split</span>.<br/>
- <span class="tactic">intros</span> <span class="id">W</span>. <span class="id">exists</span> (<span class="id">P</span> --* <span class="id">Q</span>). <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#wand_cancel">wand_cancel</a></span>.<br/>
- <span class="tactic">intros</span> (<span class="id">R</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>) <span class="id">h</span>' <span class="id">D</span> <span class="id">Ph</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">D</span>': <span class="id"><a href="CDF.Separation.html#hdisjoint">hdisjoint</a></span> <span class="id">h</span>' <span class="id">h</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#hdisjoint_sym">hdisjoint_sym</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hunion_comm">hunion_comm</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">A</span>. <span class="id">exists</span> <span class="id">h</span>', <span class="id">h</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="wand_equiv">wand_equiv</a></span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">R</span>,<br/>
&nbsp;&nbsp;(<span class="id">P</span> --&gt;&gt; (<span class="id">Q</span> --* <span class="id">R</span>)) &lt;-&gt; (<span class="id">P</span> ** <span class="id">Q</span> --&gt;&gt; <span class="id">R</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof103')">Proof.</div>
<div class="proofscript" id="proof103">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">H</span>.<br/>
- <span class="tactic">intros</span> <span class="id">h</span> (<span class="id">h1</span> &amp; <span class="id">h2</span> &amp; <span class="id">Ph1</span> &amp; <span class="id">Wh2</span> &amp; <span class="id">D</span> &amp; <span class="id">U</span>). <span class="tactic">subst</span> <span class="id">h</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#wand_intro">wand_intro</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="wand_imp_l">wand_imp_l</a></span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">P</span>' <span class="id">Q</span>,<br/>
&nbsp;&nbsp;(<span class="id">P</span>' --&gt;&gt; <span class="id">P</span>) -&gt; (<span class="id">P</span> --* <span class="id">Q</span> --&gt;&gt; <span class="id">P</span>' --* <span class="id">Q</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof104')">Proof.</div>
<div class="proofscript" id="proof104">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intros</span> <span class="id">h</span> <span class="id">W</span> <span class="id">h</span>' <span class="id">DISJ</span> <span class="id">P</span>'<span class="id">h</span>'. <span class="tactic">apply</span> <span class="id">W</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="wand_imp_r">wand_imp_r</a></span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">Q</span>',<br/>
&nbsp;&nbsp;(<span class="id">Q</span> --&gt;&gt; <span class="id">Q</span>') -&gt; (<span class="id">P</span> --* <span class="id">Q</span> --&gt;&gt; <span class="id">P</span> --* <span class="id">Q</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof105')">Proof.</div>
<div class="proofscript" id="proof105">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">intros</span> <span class="id">h</span> <span class="id">W</span> <span class="id">h</span>' <span class="id">DISJ</span> <span class="id">Ph</span>'. <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">apply</span> <span class="id">W</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="wand_idem">wand_idem</a></span>: <span class="kwd">forall</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="CDF.Separation.html#emp">emp</a></span> --&gt;&gt; <span class="id">P</span> --* <span class="id">P</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof106')">Proof.</div>
<div class="proofscript" id="proof106">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">P</span> <span class="id">h</span> <span class="id">E</span>. <span class="tactic">rewrite</span> <span class="id">E</span>. <span class="tactic">red</span>. <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hunion_empty">hunion_empty</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="wand_pure_l">wand_pure_l</a></span>: <span class="kwd">forall</span> (<span class="id">P</span>: <span class="kwd">Prop</span>) <span class="id">Q</span>,<br/>
&nbsp;&nbsp;<span class="id">P</span> -&gt; (<span class="id"><a href="CDF.Separation.html#pure">pure</a></span> <span class="id">P</span> --* <span class="id">Q</span>) = <span class="id">Q</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof107')">Proof.</div>
<div class="proofscript" id="proof107">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">PP</span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#assertion_extensionality">assertion_extensionality</a></span>. <span class="tactic">intros</span> <span class="id">h</span>; <span class="tactic">split</span>.<br/>
- <span class="tactic">intros</span> <span class="id">W</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CDF.Separation.html#hunion_empty">hunion_empty</a></span>, <span class="id"><a href="CDF.Separation.html#hunion_comm">hunion_comm</a></span> <span class="tactic">by</span> <span class="id">HDISJ</span>. <span class="tactic">apply</span> <span class="id">W</span>. <span class="id">HDISJ</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">intros</span> <span class="id">Qh</span> <span class="id">h</span>' <span class="id">DISJ</span> (<span class="id">Ph</span>' &amp; <span class="id">E</span>). <span class="tactic">subst</span> <span class="id">h</span>'. <span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hunion_comm">hunion_comm</a></span>, <span class="id"><a href="CDF.Separation.html#hunion_empty">hunion_empty</a></span> <span class="tactic">by</span> <span class="id">HDISJ</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="wand_curry">wand_curry</a></span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">R</span>,<br/>
&nbsp;&nbsp;(<span class="id">P</span> ** <span class="id">Q</span> --* <span class="id">R</span>) = (<span class="id">P</span> --* <span class="id">Q</span> --* <span class="id">R</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof108')">Proof.</div>
<div class="proofscript" id="proof108">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#assertion_extensionality">assertion_extensionality</a></span>; <span class="tactic">intros</span> <span class="id">h</span>; <span class="tactic">split</span>.<br/>
- <span class="tactic">intros</span> <span class="id">W</span> <span class="id">h1</span> <span class="id">D1</span> <span class="id">Ph1</span> <span class="id">h2</span> <span class="id">D2</span> <span class="id">Qh2</span>. <span class="tactic">rewrite</span> <span class="id"><a href="CDF.Separation.html#hunion_assoc">hunion_assoc</a></span>. <span class="tactic">apply</span> <span class="id">W</span>. <span class="id">HDISJ</span>. <span class="id">exists</span> <span class="id">h1</span>, <span class="id">h2</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>. <span class="id">HDISJ</span>.<br/>
- <span class="tactic">intros</span> <span class="id">W</span> <span class="id">h</span>' <span class="id">D</span> (<span class="id">h1</span> &amp; <span class="id">h2</span> &amp; <span class="id">Ph1</span> &amp; <span class="id">Qh2</span> &amp; <span class="id">D12</span> &amp; <span class="id">U12</span>). <span class="tactic">subst</span> <span class="id">h</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CDF.Separation.html#hunion_assoc">hunion_assoc</a></span>. <span class="tactic">apply</span> <span class="id">W</span>. <span class="id">HDISJ</span>. <span class="tactic">auto</span>. <span class="id">HDISJ</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="wand_star">wand_star</a></span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">R</span>,<br/>
&nbsp;&nbsp;((<span class="id">P</span> --* <span class="id">Q</span>) ** <span class="id">R</span> ) --&gt;&gt; (<span class="id">P</span> --* (<span class="id">Q</span> ** <span class="id">R</span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof109')">Proof.</div>
<div class="proofscript" id="proof109">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">intros</span> <span class="id">h</span> (<span class="id">h1</span> &amp; <span class="id">h2</span> &amp; <span class="id">W1</span> &amp; <span class="id">R2</span> &amp; <span class="id">D</span> &amp; <span class="id">U</span>). <span class="tactic">subst</span> <span class="id">h</span>. <span class="tactic">intros</span> <span class="id">h</span>' <span class="id">D</span>' <span class="id">Ph</span>'.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="CDF.Separation.html#hunion">hunion</a></span> <span class="id">h1</span> <span class="id">h</span>'), <span class="id">h2</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">W1</span>; <span class="tactic">auto</span>. <span class="id">HDISJ</span>.<br/>
&nbsp;&nbsp;<span class="id">HDISJ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="CDF.Separation.html#hunion_assoc">hunion_assoc</a></span>. <span class="tactic">f_equal</span>. <span class="tactic">apply</span> <span class="id"><a href="CDF.Separation.html#hunion_comm">hunion_comm</a></span>. <span class="id">HDISJ</span>.<br/>
Qed.</div>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
